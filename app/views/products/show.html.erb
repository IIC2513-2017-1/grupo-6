


<table class="no-border">
  <tbody class="no-border">

  <tr class="no-border">
      <td class="no-border" valign="top"> 
  


    <div class="product-single">
      <div class="product-gallery">
        <div id="slider-wrap">
          <ul class="slides">
          <% @product.images.each_with_index do |img, index| %>
            <li><%= image_tag img.url, class:"gallery-image" %></li> 
          <% end %>
          </ul>
          <ul class="nav-dots">
            <% @product.images.each_with_index do |img, index| %>
              <% if index != 0 %>
                <li></li> 
              <% else %>
                <li class="active"></li>
              <% end %>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
</td>
      <td class="no-border"  valign="top"> 

    <h1><%= @product.name %></h1>
    <div class="star-ratings-sprite">
      <span style="width:<%= @product.average_score()*20 %>%" class="star-ratings-sprite-rating"></span>
    </div>



    <h3>Description</h3>
    <p>
      <%= @product.description %>
    </p>

    <h3>Details</h3>
    <p>
      <%= @product.details %>
    </p>

    <h3>Prize</h3>
    <p>
      <%= @product.prize %>
    </p>

    <h3>Stock</h3>
    <p>
      <%= @product.stock %>
    </p>

    <h3>Categories</h3>
    <p>
      <ul>
      <% @product.categories.each do |category| %>
        <li><%= category.name %></li>
      <% end%>
      </ul>
    </p>

    <h3>Tags</h3>
    <p>
      <ul>
      <% @product.tags.each do |tag| %>
        <li><%= tag.name %></li>
      <% end%>
      </ul>
    </p>

    <%= form_tag("/cart/add",method:"post") do %>
      <%= hidden_field_tag("cart[product_id]", @product.id)%>
      <%= number_field("cart","quantity", value: 1, min: 1, style: "width: 40px; height: 20px;") %>
      <%= submit_tag("Add to Cart", class: "button2")%>
    <% end %>


    </td>
  </tbody>
</table>

  



<h2> Reviews </h2>
<% @product.reviews.each do |review| %>
  <div class="review-div">
    <h4> Score: <%= review.score %> </h4>
    <p> <%= review.content %> </p>
    <h5> By <%= review.user.username %> </h5>
    <div style="padding: 10px;">
    <%= link_to fa_icon("search"), review %>
    </div>
  </div>
<% end %>

<% if !@product.reviews.map{|x| x.user_id}.include? current_user&.id %>
  <%= simple_form_for(@review) do |f| %>
    <h2> Write new Review </h2>
    <% if @review.errors.any? %>
      <div id="error_explanation">
        <h2><%= pluralize(review.errors.count, "error") %> prohibited this review from being saved:</h2>

        <ul>
        <% @review.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
        </ul>
      </div>
    <% end %>

    <%= f.input :content, label: false, :input_html => {style: 'width: 800px; height: 180px;'}%>
    <%= f.hidden_field :product_id, value: @product.id %>
    <div style="float:right;">
    <%= f.input :score, input_html: {min: '0', max: '5', step: '0.5'} %>

    <div class="actions" style="float:right;">
      <%= f.submit %>
    </div></div>
  <% end %>
<% end %>

<h2> Questions & Answers </h2>
<% @product.questions.each do |question| %>
  <div class="question-div">
    <p> <%= question.content %> </p>
    <h5> By <%= question.user.username %> </h5>
    <div style="padding: 10px;">
    <%= link_to fa_icon("search"), question %>
    </div>
  </div>
<% end %>

<%= simple_form_for(@question) do |f| %>
  <h2> Write new Question </h2>
  <% if @question.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@question.errors.count, "error") %> prohibited this question from being saved:</h2>

      <ul>
      <% @question.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <%= f.input :content, label: false, :input_html => {style: 'width: 800px; height: 180px;'}%>
  <%= f.hidden_field :product_id, value: @product.id %>

  <div class="actions" style="float:right;">
    <%= f.submit %>
  </div>
<% end %>


<% if admin? %>
  <%= link_to 'Edit', edit_product_path(@product) %>
<% end %>
