<p>
  <strong>Name:</strong>
  <%= @product.name %>
</p>

<p>
  <strong>Description:</strong>
  <%= @product.description %>
</p>

<p>
  <strong>Details:</strong>
  <%= @product.details %>
</p>

<p>
  <strong>Prize:</strong>
  $<%= @product.prize %>
</p>

<p>
  <strong>Stock:</strong>
  <%= @product.stock %>
</p>

<p>
  <strong>Categories:</strong>
  <ul>
  <% @product.categories.each do |category| %>
    <li><%= category.name %></li>
  <% end%>
  </ul>
</p>

<p>
  <strong>Tags:</strong>
  <ul>
  <% @product.tags.each do |tag| %>
    <li><%= tag.name %></li>
  <% end%>
  </ul>
</p>


<h2> Images </h2>


<table class="no-border">
  <tbody class="no-border">

    <% @product.images.each_with_index do |img, index| %>
    <tr class="no-border">
      <td class="no-border"><%= image_tag img.url %> </td>
      <td class="del-icon"> <%= link_to fa_icon("trash"), product_image_path(@product, index), :method => :delete, data: { confirm: "Are you sure you want to delete this image?" }%> </td>
    <tr>
    <% end %>
  </tbody>
</table>



  


<%= form_tag("/cart/add",method:"post") do %>
  <%= hidden_field_tag("cart[product_id]", @product.id)%>
  <%= number_field("cart","quantity", value: 1, min: 1) %>
  <%= submit_tag("Add to Cart")%>
<% end %>

<h2> Reviews </h2>
<% @product.reviews.each do |review| %>
  <div class="review-div">
    <h4> Score: <%= review.score %> </h4>
    <p> <%= review.content %> </p>
    <h5> By <%= review.user.username %> </h5>
    <div style="padding: 10px;">
    <%= link_to fa_icon("search"), review %>
    </div>
  </div>
<% end %>

<% if !@product.reviews.map{|x| x.user_id}.include? current_user&.id %>
  <%= simple_form_for(@review) do |f| %>
    <h2> Write new Review </h2>
    <% if @review.errors.any? %>
      <div id="error_explanation">
        <h2><%= pluralize(review.errors.count, "error") %> prohibited this review from being saved:</h2>

        <ul>
        <% @review.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
        </ul>
      </div>
    <% end %>

    <%= f.input :content, label: false, :input_html => {style: 'width: 800px; height: 180px;'}%>
    <%= f.hidden_field :product_id, value: @product.id %>
    <div style="float:right;">
    <%= f.input :score, input_html: {min: '0', max: '5', step: '0.5'} %>

    <div class="actions" style="float:right;">
      <%= f.submit %>
    </div></div>
  <% end %>
<% end %>

<h2> Questions & Answers </h2>
<% @product.questions.each do |question| %>
  <div class="question-div">
    <p> <%= question.content %> </p>
    <h5> By <%= question.user.username %> </h5>
    <div style="padding: 10px;">
    <%= link_to fa_icon("search"), question %>
    </div>
  </div>
<% end %>

<%= simple_form_for(@question) do |f| %>
  <h2> Write new Question </h2>
  <% if @question.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@question.errors.count, "error") %> prohibited this question from being saved:</h2>

      <ul>
      <% @question.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <%= f.input :content, label: false, :input_html => {style: 'width: 800px; height: 180px;'}%>
  <%= f.hidden_field :product_id, value: @product.id %>

  <div class="actions" style="float:right;">
    <%= f.submit %>
  </div>
<% end %>


<% if admin? %>
  <%= link_to 'Edit', edit_product_path(@product) %>
  <h2>Add more images</h2>

  <%= form_for @product, url: product_images_path(@product), method: :post do |f| %> 
    <%= f.file_field :images, multiple: true, required: true %>
    <%= f.submit "Add More Images" %>
  <% end %>
<% end %>
